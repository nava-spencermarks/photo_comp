{% extends "base.html" %}

{% block content %}
<div class="card">
    <h2 class="result-title">
        Comparison Results
    </h2>
    
    <div class="image-container">
        <div class="image-box">
            <h3>First Image</h3>
            <img src="{{ url_for('uploaded_file', filename=image1) }}" 
                 alt="First uploaded image">
            <p class="result-description">
                {{ image1 }}
            </p>
        </div>
        
        <div class="image-box">
            <h3>Second Image</h3>
            <img src="{{ url_for('uploaded_file', filename=image2) }}" 
                 alt="Second uploaded image">
            <p class="result-description">
                {{ image2 }}
            </p>
        </div>
    </div>
    
    <div class="result-container">
        {% if is_same_person %}
            <div class="result-badge same-person">
                ‚úÖ SAME PERSON
            </div>
            <p class="result-text-success">
                The faces in both images appear to be the same person
            </p>
        {% else %}
            <div class="result-badge different-person">
                ‚ùå DIFFERENT PEOPLE
            </div>
            <p class="result-text-error">
                The faces in the images appear to be different people
            </p>
        {% endif %}
    </div>
    
    {% if mask_applied %}
    <div class="mask-info">
        <h4 class="mask-info-title">üéØ Masked Comparison Applied</h4>
        <p class="mask-info-text">
            Rectangle masks were applied to focus comparison on specific regions.
        </p>
        {% if mask_stats %}
        <div class="mask-info-details">
            <p>‚Ä¢ Rectangles used: {{ rectangles_count }}</p>
            <p>‚Ä¢ Masked area: {{ "%.1f"|format(mask_stats.mask_percentage) }}% of image</p>
            <p>‚Ä¢ Compared area: {{ "%.1f"|format(mask_stats.unmasked_percentage) }}% of image</p>
        </div>
        {% endif %}
    </div>
    {% endif %}
    
    <div class="details">
        <h4 class="technical-details-title">Technical Details:</h4>
        <p class="technical-details-text">{{ details }}</p>
        <p class="technical-details-note">
            <strong>Confidence Level:</strong> {{ confidence }}
        </p>
        {% if mask_applied %}
        <p class="technical-details-note">
            <strong>Comparison Method:</strong> Masked regions ({{ rectangles_count }} rectangle{% if rectangles_count != 1 %}s{% endif %})
        </p>
        {% else %}
        <p class="technical-details-note">
            <strong>Comparison Method:</strong> Full image analysis
        </p>
        {% endif %}
    </div>
    
    <div class="back-button-container">
        <a href="{{ url_for('index') }}" class="btn back-button">
            üîÑ Compare More Images
        </a>
    </div>
</div>

<div class="card">
    <h3 class="understanding-title">Understanding the Results:</h3>
    <div class="understanding-content">
        <p><strong>Distance:</strong> Lower values indicate higher similarity (same person)</p>
        <p><strong>Threshold:</strong> Values below the threshold suggest same person</p>
        <p><strong>Confidence:</strong> Based on face detection quality and comparison metrics</p>
        
        {% if is_same_person %}
        <div class="result-explanation-success">
            <p><strong>‚úÖ Match Found:</strong> The facial features, structure, and measurements between the two images show high similarity, indicating they likely contain the same person.</p>
        </div>
        {% else %}
        <div class="result-explanation-error">
            <p><strong>‚ùå No Match:</strong> The facial features show significant differences, or faces could not be properly detected in one or both images.</p>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}